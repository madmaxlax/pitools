<!DOCTYPE html>
<html lang="en" ng-app="myapp" ng-controller="appController as ctrlr">

<head>
	<title ng-bind="'STCA PI Tools Reports - Web'">STCA PI Tools Reports - Web</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="../favicon.ico">
	<link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32.png">
	<link rel="apple-touch-icon" href="../images/icons/apple-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/icons/apple-icon-72x72.png">
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">-->
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.1/angular-material.min.css">
	<link rel="stylesheet" type="text/css" href="styles.css" />

</head>

<body ng-keypress="shortcutKeypress($event)">
	<md-toolbar layout="row" class="md-toolbar-tools" ng-cloak layout-align="space-between center">
		<h1>STCA PI Tools Reports-Web</h1>
		<md-button class="menu md-icon-button" hide-gt-md ng-click="toggleLeft()" aria-label="Show Nav">
			<md-icon aria-label="settings" class="material-icons">settings</md-icon>
		</md-button>
	</md-toolbar>

	<div flex layout="row" ng-cloak>
		<div ng-show="errors.length" class="md-warn">
			<div ng-repeat="error in errors">
				<div ng-repeat="(errname, errmsg) in error"><strong>{{errname}}</strong>: {{errmsg}}
					<!-- <ul>
						<li ng-repeat="(errmsgname, errmsgdetail) in errmsg">{{errmsgname+':'+errmsgdetail}}</li>
					</ul> -->
				</div>
			</div>
			<button type="button" class="close" ng-click="clearErrors()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
		</div>
		<div layout="column" flex>
			<md-content flex>
				<!-- Plant search auto complete -->
				<form ng-submit="$event.preventDefault()" layout layout-align="center" layout-padding>
					<div layout="row" flex>
						<md-autocomplete flex ng-disabled="!data.plants.length" md-selected-item="data.selectedPlant.both" md-selected-item-change="getPlantData()"
						 class="md-block" md-search-text="preferences.plantSearchText" md-items="plant in data.plants | filter:preferences.plantSearchText"
						 md-select-on-focus md-select-on-match="true" md-item-text="plant.Name.replace('Plant ID ','')" md-floating-label="{{data.plants.length?'Search for a plant':'Loading Plants...'}}"
						 md-min-length="0" md-input-id="search-input-plants">
							<md-item-template>
								<span md-highlight-text="preferences.plantSearchText" md-highlight-flags="i">{{plant.Name.replace('Plant ID ','')}}</span>
							</md-item-template>
							<md-not-found>
								No plants found "{{preferences.plantSearchText}}"
							</md-not-found>
						</md-autocomplete>
						<div>
							<md-button class="md-raised" ng-click="getPlantData()">
								Search /
								<md-icon aria-label="refresh" class="material-icons">autorenew</md-icon>
							</md-button>
						</div>
					</div>
				</form>
			</md-content>
			<md-content layout-xs="column" layout="row" layout-wrap>
				{{data.selectedPlant.Name}}
				<br/>
				<div flex="100" layout="column">
					<md-card>
						<!-- <img ng-src="{{imagePath}}" class="md-card-image" alt="Washed Out"> -->
						<md-card-title>
							<md-card-title-text>
								<span class="md-headline">Experiment and Period Numbers</span>
							</md-card-title-text>
						</md-card-title>
						<md-card-content>
							<md-input-container>
								<label>Experiment Name</label>
								<input ng-model="currentPlantReportSettings.experimentName">
							</md-input-container>
							<md-input-container>
								<label>Experiment Number</label>
								<input ng-model="currentPlantReportSettings.experimentNumber">
							</md-input-container>
							<md-input-container>
								<label>Period Name</label>
								<input ng-model="currentPlantReportSettings.periodName">
							</md-input-container>
							<md-input-container>
								<label>Period Number</label>
								<input ng-model="currentPlantReportSettings.periodNumber">
							</md-input-container>

						</md-card-content>
					</md-card>
				</div>
				<div flex-xs flex-gt-xs="50" layout="column">
					<md-card>
						<!-- <img ng-src="{{imagePath}}" class="md-card-image" alt="Washed Out"> -->
						<md-card-title>
							<md-card-title-text>
								<span class="md-headline">Period Retrieval Method</span>
							</md-card-title-text>
						</md-card-title>
						<md-card-content>
							<md-radio-group ng-model="currentPlantReportSettings.method">
								<div layout="row">
									<div flex-xs flex-gt-xs="50">
										<md-radio-button value="interval" class="md-primary">Interval Time (mins)</md-radio-button>
									</div>
									<div flex-xs flex-gt-xs="50">
										<md-input-container>
											<label>minutes</label>
											<input ng-disabled="!(currentPlantReportSettings.method=='interval')" ng-model="currentPlantReportSettings.intervalMinutes">
										</md-input-container>
									</div>
								</div>
								<div layout="row">
									<div flex-xs flex-gt-xs="50">
										<md-radio-button value="eventTag"> Event Tag </md-radio-button>
									</div>
									<div flex-xs flex-gt-xs="50">
										<md-input-container>
											<label>Select Event Tag</label>
											<md-select ng-disabled="!(currentPlantReportSettings.method=='eventTag')" ng-model="currentPlantReportSettings.eventTag">
												<md-option><em>None</em></md-option>
												<md-option>Eventtag1</md-option>
												<md-option>Eventtag2</md-option>
												<md-option>...</md-option>
											</md-select>
										</md-input-container>
									</div>
								</div>
								<md-radio-button ng-disabled="true" value="GC Reports">GC Reports (??)</md-radio-button>
							</md-radio-group>
							<div layout="row">
								<div flex="50">
									Start Date/Time
									<br>
									<md-input-container>
										<label>Start Date</label>
										<md-datepicker ng-model="currentPlantReportSettings.startDate" md-open-on-focus></md-datepicker>
									</md-input-container>
									<md-input-container>
										<label>Time</label>
										<input ng-model="currentPlantReportSettings.startTime" type="time">
									</md-input-container>
								</div>
								<div flex="50">
									End Date/Time
									<br>

									<md-input-container>
										<label>End Date</label>
										<md-datepicker ng-model="currentPlantReportSettings.endDate" md-open-on-focus></md-datepicker>
									</md-input-container>
									<md-input-container>
										<label>End Time</label>
										<input ng-model="currentPlantReportSettings.endTime" type="time">
									</md-input-container>
								</div>
							</div>
						</md-card-content>
					</md-card>
				</div>


				<div flex-xs flex-gt-xs="50" layout="column">
					<md-card>
						<!-- <img ng-src="{{imagePath}}" class="md-card-image" alt="Washed Out"> -->
						<md-card-title>
							<md-card-title-text>
								<span class="md-headline">Report Settings</span>
								<span class="md-subhead">Your selected file format: {{(currentPlantReportSettings.reportFileNameWithExpPerNums?'[exp#]-[per#]':'plant[currentplant]')
									+(currentPlantReportSettings.reportType==='hydra'?'.nox':'.R02')}}</span>
							</md-card-title-text>
						</md-card-title>
						<md-card-content>

							<div layout="row">
								<div flex-xs flex-gt-xs="50">

									<br> <span class="md-strong">Type of Report</span>
									<br>
									<br>
									<md-radio-group ng-model="currentPlantReportSettings.reportType">
										<md-radio-button value="hydra" class="md-primary">Hydra (.NOX files)
											<md-tooltip md-direction="top">
												Format looks like ...
											</md-tooltip>
										</md-radio-button>
										<md-radio-button value="run" class="">
											Run report (.R02 files)
											<md-tooltip md-direction="top">
												Format looks like ...
											</md-tooltip>
										</md-radio-button>
									</md-radio-group>
								</div>

								<div flex-xs flex-gt-xs="50" layout="column">
									<md-switch flex-xs flex-gt-xs="50" ng-model="currentPlantReportSettings.reportFileNameWithExpPerNums">
										<md-tooltip md-direction="top">
											how the file names of the reports will be set up
										</md-tooltip>
										Include exp # and per # in file name?
									</md-switch>
									<md-switch flex-xs flex-gt-xs="50" ng-model="currentPlantReportSettings.removeSTCAprefix">
										<md-tooltip md-direction="top">
											Whether or not to remove the 'STCA' text in the tag names for the report file
										</md-tooltip>
										Remove STCA prefix? {{(currentPlantReportSettings.removeSTCAprefix?'9999':'STCA9999')}}
									</md-switch>
								</div>
							</div>
						</md-card-content>
					</md-card>
				</div>
				<div flex-xs flex-gt-xs="100" layout="column">
					<md-card>
						<!-- <img ng-src="{{imagePath}}" class="md-card-image" alt="Washed Out"> -->
						<md-card-title>
							<md-card-title-text>
								<span class="md-headline">PI Tag Select</span>
							</md-card-title-text>
						</md-card-title>
						<md-card-content>
							something clever here. maybe checkboxes?
							<md-input-container>
								<label>Filter Tags</label>
								<input ng-model="selectTagsFiltertext">
							</md-input-container>
							<div layout="row">
								<div flex-xs flex-gt-xs="50">
									Tags available
									<md-checkbox ng-model="selectAllTags">Select All?</md-checkbox>
									<br>
									<div ng-repeat="tag in testTags | filter:selectTagsFiltertext">
										<md-checkbox ng-checked="selectAllTags" ng-model="currentPlantReportSettings.selectedTags[tag]">{{tag}}</md-checkbox>
									</div>
								</div>
								<div flex-xs flex-gt-xs="50">
									Tags selected ({{currentPlantReportSettings.selectedTags | keyLength}})
									<br>
									<div ng-repeat="(tagName, value) in currentPlantReportSettings.selectedTags" ng-if="value">{{tagName}}</div>
								</div>
							</div>
						</md-card-content>
					</md-card>
				</div>

				<div flex-xs flex-gt-xs="100" layout="column">
					<md-card>
						<!-- <img ng-src="{{imagePath}}" class="md-card-image" alt="Washed Out"> -->
						<md-card-title>
							<md-card-title-text>
								<span class="md-headline">Generate Reports</span>
							</md-card-title-text>
						</md-card-title>
						<md-card-content>
							Ready to generate {x} reports based on your settings?
							
							<md-button class="md-raised md-accent" ng-click="generateReports()">Get Report files
							</md-button>
							 <br>
							 Reports:
							 <br>
							 
							<md-button ng-repeat="(reportNumber, value) in generatedReports" class="md-raised " ng-click="openReport(reportNumber)">open report {{reportNumber}}
								</md-button>

						</md-card-content>
					</md-card>
				</div>
			</md-content>
		</div>
		<md-sidenav class="md-sidenav-right" md-is-locked-open="$mdMedia('gt-md')" md-component-id="right" ng-click="">
			<md-content class="md-padding">
				<md-list>
					<md-subheader class="">Preferences</md-subheader>

					<md-list-item>

					</md-list-item>
					<div layout="row" layout-align="center center">
						<md-button class="md-raised md-accent" ng-click="savepreferences()">Save Settings
							<md-icon aria-label="save" class="material-icons">save</md-icon>
						</md-button>
					</div>
					<md-divider></md-divider>
					<div layout="row" layout-align="center center">
						<md-button class="" ng-disabled="" target="_blank" href="https://muntse-s-08817.europe.shell.com/piwebapi/help">
							PI Web API Link
							<md-icon aria-label="help" class="material-icons">help_outline</md-icon>
							<md-tooltip md-direction="botom">
								Click here if having problems getting data the first time.
							</md-tooltip>
						</md-button>
					</div>
					<md-divider></md-divider>

				</md-list>
			</md-content>
		</md-sidenav>
	</div>
	<script src="./scripts/jquery.min.js"></script>
	<script src="./scripts/bootstrap.min.js"></script>
	<script src="./scripts/angular.min.js"></script>
	<script src="./scripts/angular-resource.min.js"></script>
	<script src="./scripts/angular-route.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-animate.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-aria.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular-messages.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.1/angular-material.min.js"></script>
	<script src="./scripts/nglocalstorage.js"></script>
	<script src="./scripts/angular-timeago.min.js"></script>
	<script src="./scripts/app.js"></script>

	<!-- 	<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.4.0/less.min.js" type="text/javascript"></script> -->
</body>

</html>